VERSION = 0.996-6
DIC_VERSION = 102

ifeq "$(MECAB_DEFAULT_RC)" ""
MECAB_DEFAULT_RC = /etc/mecabrc
endif

CXX_STD = CXX17
PKG_CXXFLAGS = -DSTRICT_R_HEADERS \
	-DHAVE_STDINT_H -DHAVE_UNISTD_H -DHAVE_STRING_H -DHAVE_FCNTL_H \
	-DHAVE_SYS_STAT_H -DHAVE_SYS_TYPES_H -DHAVE_SYS_MMAN_H -DHAVE_DIRENT_H \
	-DHAVE_CXX17_FALLTHROUGH_ATTRIBUTE \
	-DDIC_VERSION="$(DIC_VERSION)" \
	-DMECAB_USE_UTF8_ONLY \
	-DVERSION="\"$(VERSION)\"" -DPACKAGE="\"mecab\"" \
	-DMECAB_DEFAULT_RC="\"$(MECAB_DEFAULT_RC)\""
PKG_LIBS = $(shell "$(R_HOME)/bin/Rscript" -e "RcppParallel::RcppParallelLibs()") -lpthread

OBJ = feature_index.o param.o learner.o string_buffer.o \
	char_property.o         learner_tagger.o    tagger.o \
	connector.o             tokenizer.o \
	context_id.o            dictionary.o  utils.o \
	dictionary_compiler.o   viterbi.o \
	dictionary_generator.o  writer.o iconv_utils.o \
	dictionary_rewriter.o   lbfgs.o eval.o nbest_generator.o

.PHONY: all

all: $(SHLIB)

$(SHLIB): $(OBJECTS) $(OBJ) libmecab.o

clean:
	rm -f $(OBJECT) $(OBJ) $(SHLIB)
